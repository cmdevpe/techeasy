<!DOCTYPE html>
<html class="dark" lang="es">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Dashboard | Mi Cuenta</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300..700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
      rel="stylesheet"
    />
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#0da6f2",
              "background-light": "#f5f7f8",
              "background-dark": "#101c22",
            },
            fontFamily: {
              display: ["Space Grotesk", "sans-serif"],
            },
            borderRadius: {
              DEFAULT: "0.25rem",
              lg: "0.5rem",
              xl: "0.75rem",
              full: "9999px",
            },
          },
        },
      };
    </script>
    <style>
      .material-symbols-outlined {
        font-variation-settings: "FILL" 0, "wght" 400, "GRAD" 0, "opsz" 24;
      }
    </style>
  </head>
  <body
    class="bg-background-light dark:bg-background-dark font-display text-gray-800 dark:text-gray-200"
  >
    <div
      class="relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden"
    >
      <div class="layout-container flex h-full grow flex-col">
        <div class="flex flex-1 justify-center">
          <div
            class="layout-content-container flex w-full flex-col max-w-6xl px-4 sm:px-6 lg:px-8"
          >
            <div id="header-placeholder"></div>

            <main class="flex flex-1 justify-center py-10">
              <div
                class="layout-content-container flex flex-col w-full max-w-4xl flex-1"
              >
                <h1
                  class="text-gray-900 dark:text-white text-4xl font-black leading-tight tracking-[-0.033em] mb-4"
                >
                  Hola, <span id="user-name">Yamcer</span>
                </h1>
                <p class="text-gray-600 dark:text-gray-400 text-lg mb-8">
                  Este es tu panel de control. Gestiona tu cuenta, pedidos y
                  favoritos.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                  <a
                    href="orders.html"
                    class="flex flex-col items-center justify-center p-6 bg-white dark:bg-[#1b2327] rounded-xl shadow-sm border border-gray-200 dark:border-gray-700/50 hover:border-primary transition-colors text-center"
                  >
                    <span
                      class="material-symbols-outlined text-4xl text-primary mb-2"
                      >shopping_bag</span
                    >
                    <p class="text-xl font-bold text-gray-900 dark:text-white">
                      Mis Pedidos
                    </p>
                    <p class="text-sm text-gray-500 dark:text-gray-400">
                      Revisa el historial y estado de tus compras.
                    </p>
                  </a>

                  <a
                    href="checkout.html"
                    class="flex flex-col items-center justify-center p-6 bg-white dark:bg-[#1b2327] rounded-xl shadow-sm border border-gray-200 dark:border-gray-700/50 hover:border-primary transition-colors text-center"
                  >
                    <span
                      class="material-symbols-outlined text-4xl text-primary mb-2"
                      >shopping_cart</span
                    >
                    <p class="text-xl font-bold text-gray-900 dark:text-white">
                      Carrito Activo
                    </p>
                    <p class="text-sm text-gray-500 dark:text-gray-400">
                      Finaliza tus compras pendientes.
                    </p>
                  </a>

                  <button onclick="window.location.href = 'index.html'"
                    id="logout-button"
                    class="flex flex-col items-center justify-center p-6 bg-red-50 dark:bg-red-900/40 rounded-xl shadow-sm border border-gray-200 dark:border-red-800 hover:bg-red-100 dark:hover:bg-red-900/60 transition-colors text-center"
                  >
                    <span
                      class="material-symbols-outlined text-4xl text-red-600 dark:text-red-400 mb-2"
                      >logout</span
                    >
                    <p class="text-xl font-bold text-red-600 dark:text-red-400">
                      Cerrar Sesi칩n
                    </p>
                    <p class="text-sm text-red-400 dark:text-red-500">
                      Salir de tu cuenta.
                    </p>
                  </button>
                </div>
              </div>
            </main>

            <div id="footer-placeholder"></div>
          </div>
        </div>
      </div>

      <div id="modals-placeholder"></div>
    </div>

    <script type="module">
  import { loadLayout } from "./js/loader.js";
  await loadLayout();

  import { initializeApp } from "./js/app.js";
  initializeApp();

  document.addEventListener("DOMContentLoaded", () => {
    const userNameElement = document.getElementById("user-name");
    const accountEmailElement = document.getElementById("account-email");
    const logoutButton = document.getElementById("logout-button");

    const userData = sessionStorage.getItem("techEaseUser");

    if (!userData) {
      sessionStorage.setItem("techEaseRedirectTo", window.location.href);
      window.location.href = "login.html";
      return;
    }

    let user = {};
    try {
      user = JSON.parse(userData);
    } catch (e) {
      console.error("Error parsing user data:", e);
      window.location.href = "login.html";
      return;
    }

    // Mostrar datos del usuario
    if (userNameElement) {
      // Muestra solo el primer nombre si existe un espacio
      const firstName = user.name ? user.name.split(" ")[0] : "Usuario";
      userNameElement.textContent = firstName;
    }
    // Nota: accountEmailElement no est치 en el HTML provisto, se usa console.error si falla
    if (accountEmailElement) {
      accountEmailElement.textContent = `Email: ${user.email}`;
    }

    // Cierre de Sesi칩n: Redirecciona a index.html
    if (logoutButton) {
      logoutButton.addEventListener("click", () => {
        sessionStorage.removeItem("techEaseUser");
        sessionStorage.removeItem("techEaseRedirectTo");
        alert("Has cerrado sesi칩n.");
        window.location.href = "index.html";
      });
    }
  });
</script>
  </body>
</html>
